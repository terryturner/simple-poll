jib {

    from {
        image = "openjdk:11-jre-slim-stretch"
    }

    to {
        image = "docker.io/terryturner/simple-poll"
        project.afterEvaluate {
            tags = [version]
        }
        auth {
            username "$hubUserName"
            password "$hubPassWord"
        }
    }

    container {
        workingDirectory = "/"
        entrypoint = ["sh", "-c", "chmod +x /entrypoint.sh && sync && . /entrypoint.sh"]
        ports = ["8080"]
        environment = [
                SPRING_OUTPUT_ANSI_ENABLED: "ALWAYS",
                DEMO_SLEEP: "0"
        ]
        creationTime = "USE_CURRENT_TIMESTAMP"
    }
    allowInsecureRegistries = true
    extraDirectories.paths = ['src/main/jib']
}


